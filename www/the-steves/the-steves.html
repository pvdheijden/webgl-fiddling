<!DOCTYPE html>
<html>
	<head>
		<title>The Steves</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<!-- Bootstrap -->
		<link rel="stylesheet" href="../libs/bootstrap/css/bootstrap.min.css">
		<style type="text/css">
			body {
				padding-top: 20px;
				padding-bottom: 20px;
				margin-bottom: 20px;
			}
	    </style>
		<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
		<script src="../libs/jquery/jquery-2.1.0.min.js"></script>
		<!-- Include all compiled plugins (below), or include individual files as needed -->
		<script src="../libs/bootstrap/js/bootstrap.min.js"></script>

		<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!--[if lt IE 9]>
			<script src="http://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.2/html5shiv.js"></script>
			<script src="http://cdnjs.cloudflare.com/ajax/libs/respond.js/1.2.0/respond.js"></script>
		<![endif]-->

		<script type="text/javascript" src="../libs/async/async.js"></script>
		<script type="text/javascript" src="../libs/three.js/three.js"></script>
		<script type="text/javascript" src="../libs/steve/steve.js"></script>
	</head>

	<body>

	<div class="container">
	<!-- Menu balk -->
	<div class="navbar navbar-default" role="navigation">
		<div class=navbar-header>
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a href="//webgl.zifzaf.net" class="navbar-brand">ZifZaf</a>
		</div>

		<div class="navbar-collapse collapse">
			<ul class="nav navbar-nav">
				<li class="active"><a href="/index.html">Home</a></li>
			</ul>
		</div>
	</div>

	<!-- De eigenlijke pagina -->
	<div class="row text-center">
		<div class="col-md-12">
		    <canvas id="canvas" width="800" height="600">
				Your browser does not support HTML5
		    </canvas>
		</div><!-- /.col-md-12 -->
	</div><!-- /.row -->

	<div class ="row text-center">
		<div class="col-md-2">
			<img id="skin1" class="center-block" src="../skins/blockypixel.png" alt="Blocky Pixel's skin">
		</div>
		<div class="col-md-2">
			<img id="skin2" class="center-block" src="../skins/mudkipgirl.png" alt="Mudkip girl's skin">
		</div>
		<div class="col-md-2">
			<img id="skin3" class="center-block" src="../skins/firedragon.png" alt="Firedragon's skin">
		</div>
		<div class="col-md-2">
			<img id="skin4" class="center-block" src="../skins/creeper.png" alt="Creeper's skin">
		</div>
	</div>

	<script type="text/javascript">
		function get_skin_data(skin) {
			var context = $("<canvas>")[0].getContext("2d");
			context.drawImage(skin, 0, 0);
			return context.getImageData(0, 0, skin.width, skin.height);
		};

		$(function () {
			var scene = new THREE.Scene();

			// Ambiant light
			var ambiant = new THREE.AmbientLight( 0xf0f0f0 ); // soft white light
			scene.add(ambiant);

			// Create a directional light to show off the object
			//var light = new THREE.DirectionalLight( 0xffffff, 1.5);
			//light.position.set(0, 0, 8);
			//scene.add(light);

			var camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 1, 1000); 
			camera.position.set(0, 0, 36);

            var canvas = $("#canvas")[0];
			var renderer = new THREE.WebGLRenderer( { 
				"canvas": canvas,
				"antialias": true 
			} );
			renderer.setSize(canvas.width, canvas.height);
			renderer.setClearColor(0xffffff);

			async.parallel([
				function (callback) {
					$("#skin4").one("load", function() {
						callback(null, get_skin_data( $("#skin4")[0]));
					});
				},
				function (callback) {
					$("#skin2").one("load", function() {
						callback(null, get_skin_data( $("#skin2")[0]));
					});
				},
				function (callback) {
					$("#skin3").one("load", function() {
						callback(null, get_skin_data( $("#skin3")[0]));
					});
				}
			], function (err, skin_data) {
                var the_steves = new THREE.Object3D();
                scene.add(the_steves);

				var steveThree = new Steve(skin_data[0]);
                the_steves.add(steveThree);
                steveThree.do_pose(Steve.HI_POSE);
				steveThree.rotation.y = -30 * 0.0175;

				var steveOne = new Steve(skin_data[1]);
                the_steves.add(steveOne);
                steveOne.do_pose(Steve.WALK_POSE);
				steveOne.rotation.y = -5 * 0.0175;
				steveOne.position.x = -20;

				var steveTwo = new Steve(skin_data[2]);
                the_steves.add(steveTwo);
                steveTwo.do_pose(Steve.PARADE_POSE);
				steveTwo.rotation.y = 10 * 0.0175;
				steveTwo.position.x += 20;

                the_steves.rotation.y = 0 * 0.0175;

				renderer.render(scene, camera);				
			});
		});
	</script>

	</body>	

</html>
